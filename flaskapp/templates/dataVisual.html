{% extends 'base.html' %}

{% block title %}JPL UCR Project - Visualize Data{% endblock %}

{% block content %}
    <div>
        <h1>Visualize Data</h1>
    </div>
	<div id="mapid" style="width: 600px; height:400px; position: absolute; outline: none;"></div>
	<script>
		/*
		var token = "pk.eyJ1IjoibWFrYmEwMDIiLCJhIjoiY2syOW40b3NqMHdhazNsbXNybHA2dnAzdSJ9.ihFn0ArkcGyiig4pK58uOQ";
		var addrmapbox = "https://api.tiles.mapbox.com/v4/{id}/{z}/{y}/{x}.png?access_token=";

		var val = "".concat(addrmapbox,token);
		
		var osm = L.tileLayer( 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFrYmEwMDIiLCJhIjoiY2syOW40b3NqMHdhazNsbXNybHA2dnAzdSJ9.ihFn0ArkcGyiig4pK58uOQ' , {
			maxZoom:18,
			attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
			id: 'mapbox.streets'
		});

		var lyr = L.tileLayer('/home/afshancloud/flaskapp/tifs/paulitiles/./{z}/{x}/{y}.png', {tms: true, opacity: 0.7, attribution: ""});
		
		var map = L.map('mapid', {
			center: [30.1982589383, -94.7330134442],
			zoom: 4,
			minZoom: 2,
			maxZoom: 4,
			layers: [osm]
		});

		var basemaps = {"OpenStreetmap": osm};
		var overlaymaps = {"Layer": lyr};

		var title = L.control();
		title.onAdd = function(map) {
			this._div = L.DomUtil.create('div', 'ctl title');
			this.update();
			return this._div;
		};
		title.update = function(props) {
			this._div.innerHTML = "pauli.tif";
		};
		title.addTo(map);

		var src = 'Generated by <a href="http://www.klokan.cz/projects/gdal2tiles/">GDAL2Tiles</a>, Copyright &copy; 2008 <a href="http://www.klokan.cz/">Klokan Petr Pridal</a>,  <a href="http://www.gdal.org/">GDAL</a> &amp; <a href="http://www.osgeo.org/">OSGeo</a> <a href="http://code.google.com/soc/">GSoC</a>';
        var title = L.control({position: 'bottomleft'});
        title.onAdd = function(map) {
            this._div = L.DomUtil.create('div', 'ctl src');
            this.update();
            return this._div;
        };
        title.update = function(props) {
            this._div.innerHTML = src;
        };
        title.addTo(map);
        L.control.layers(basemaps, overlaymaps, {collapsed: false}).addTo(map);
        map.fitBounds([[29.4898508766, -94.1802658885], [30.906667, -95.285761]]);
		*/
		// Base layers
        //  .. OpenStreetMap
        // Limit leaflet map zoom to a list of variants
		// Written by Ilya Zverev, licensed WTFPL

		L.Map.mergeOptions({
			zooms: [] // array of integers
		});

		L.Map.include({
			_limitZoom: function (zoom) {
				var zooms = this.options.zooms;
				if (!zooms || !('length' in zooms) || !zooms.length) {
					var min = this.getMinZoom(),
					    max = this.getMaxZoom(),
					    snap = L.Browser.any3d ? this.options.zoomSnap : 1;
					if (snap) {
						zoom = Math.round(zoom / snap) * snap;
					}
					return Math.max(min, Math.min(max, zoom));
				} else {
					var z, d = 100, i, dist;
					var dz = -1, dd = 100, dir = zoom - this._zoom;
					var snap = L.Browser.any3d ? this.options.zoomSnap : 1;
					if (snap) {
						zoom = Math.round(zoom / snap) * snap;
					}
					for (i = 0; i < zooms.length; i++) {
						dist = Math.abs(zooms[i] - zoom);
						if (dist < d) {
							z = zooms[i];
							d = dist;
						}
						if (dir * (zooms[i] - this._zoom) > 0 && dist < dd) {
							dz = zooms[i];
							dd = dist;
						}
					}
					return dz < 0 ? z : dz;
				}
			}
		});


        var osm = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'});

        // Overlay layers (TMS)
        var lyr = L.tileLayer('/static/paulitiles/{z}/{x}/{-y}.png', {
        	opacity: 0.7, 
        	attribution: "",
			maxNativeZoom: 1,
			minNativeZoom: 10,
			minZoom: 0,
			maxZoom: 20,
        });

        // Map
        var map = L.map('mapid', {
            center: [30.1982589383, -94.7330134442],
            zoom: 8,
            minZoom: 1,
            maxZoom: 20,
            layers: [osm]
        });

        var basemaps = {"OpenStreetMap": osm}
        var overlaymaps = {"Layer": lyr}

        // Title
        var title = L.control();
        title.onAdd = function(map) {
            this._div = L.DomUtil.create('div', 'ctl title');
            this.update();
            return this._div;
        };
        title.update = function(props) {
            this._div.innerHTML = "pauli.tif";
        };
        title.addTo(map);

        // Note
        var src = 'Generated by <a href="http://www.klokan.cz/projects/gdal2tiles/">GDAL2Tiles</a>, Copyright &copy; 2008 <a href="http://www.klokan.cz/">Klokan Petr Pridal</a>,  <a href="http://www.gdal.org/">GDAL</a> &amp; <a href="http://www.osgeo.org/">OSGeo</a> <a href="http://code.google.com/soc/">GSoC</a>';
        var title = L.control({position: 'bottomleft'});
        title.onAdd = function(map) {
            this._div = L.DomUtil.create('div', 'ctl src');
            this.update();
            return this._div;
        };
        title.update = function(props) {
            this._div.innerHTML = src;
        };
        title.addTo(map);


        // Add base layers
        L.control.layers(basemaps, overlaymaps, {collapsed: true}).addTo(map);

        // Fit to overlay bounds (SW and NE points with (lat, lon))
        map.fitBounds([[29.4898508766, -94.1802658885], [30.906667, -95.285761]]);
	</script>

{% endblock %}
